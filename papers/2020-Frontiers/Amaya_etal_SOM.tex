%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% This is just an example/guide for you to refer to when submitting manuscripts to Frontiers, it is not mandatory to use Frontiers .cls files nor frontiers.tex  %
% This will only generate the Manuscript, the final article will be typeset by Frontiers after acceptance.   
%                                              %
%                                                                                                                                                         %
% When submitting your files, remember to upload this *tex file, the pdf generated with it, the *bib file (if bibliography is not within the *tex) and all the figures.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Version 3.4 Generated 2018/06/15 %%%
%%% You will need to have the following packages installed: datetime, fmtcount, etoolbox, fcprefix, which are normally inlcuded in WinEdt. %%%
%%% In http://www.ctan.org/ you can find the packages and how to install them, if necessary. %%%
%%%  NB logo1.jpg is required in the path in order to correctly compile front page header %%%

\documentclass[utf8]{frontiersSCNS} % for Science, Engineering and Humanities and Social Sciences articles
%\documentclass[utf8]{frontiersHLTH} % for Health articles
%\documentclass[utf8]{frontiersFPHY} % for Physics and Applied Mathematics and Statistics articles

%\setcitestyle{square} % for Physics and Applied Mathematics and Statistics articles
\usepackage{url,hyperref,lineno,microtype,subcaption,booktabs,amssymb,amsmath,multirow}
\usepackage[onehalfspacing]{setspace}

\linenumbers


% Leave a blank line between paragraphs instead of using \\


\def\keyFont{\fontsize{8}{11}\helveticabold }
\def\firstAuthorLast{Amaya {et~al.}} %use et al only if is more than 1 author
\def\Authors{Jorge Amaya\,$^{1,*}$, Romain Dupuis\,$^{1}$, Maria-Elena Innocenti$^{2}$ and Giovanni Lapenta\,$^{1}$}
% Affiliations should be keyed to the author's name with superscript numbers and be listed as follows: Laboratory, Institute, Department, Organization, City, State abbreviation (USA, Canada, Australia), and Country (without detailed address information such as city zip codes or street names).
% If one of the authors has a change of address, list the new address below the correspondence details using a superscript symbol and use the same symbol to indicate the author in the author list.
\def\Address{$^{1}$Centre for mathematical Plasma-Astrophysics, CmPA, Mathematics Department, KU Leuven, University of Leuven, Belgium \\
$^{2}$Jet Propulsion Laboratory, Interstellar and Heliospheric Physics Division, 4800 Oak Grove Dr, Pasadena, CA 91109, USA}
% The Corresponding Author should be marked with an asterisk
% Provide the exact contact address (this time including street name and city zip code) and email of the corresponding author
\def\corrAuthor{Jorge Amaya, Mathematics Department, Celestijnenlaan 200B, KU Leuven, 3001 Leuven, Belgium}

\def\corrEmail{jorge.amaya@kuleuven.be, jorgeluis.amaya@gmail.com}
\graphicspath{{figures/}}


\begin{document}

\onecolumn
\firstpage{1}

\title[Unsupervised Clustering of the Solar Wind]{Classification of the Solar Wind Using Unsupervised Clustering} 

\author[\firstAuthorLast ]{\Authors} %This field will be automatically populated
\address{} %This field will be automatically populated
\correspondance{} %This field will be automatically populated

\extraAuth{}% If there are more than 1 corresponding author, comment this line and uncomment the next one.
%\extraAuth{corresponding Author2 \\ Laboratory X2, Institute X2, Department X2, Organization X2, Street X2, City X2 , State XX2 (only USA, Canada and Australia), Zip Code2, X2 Country X2, email2@uni2.edu}


\maketitle
me

\begin{abstract}

%%% Leave the Abstract empty if your article does not require one, please see the Summary Table for full details.
\section{}
\input{sections/abstract}

This is the \href{https://github.com/murci3lag0}{link to my personal GitHub page}.

\tiny
 \keyFont{ \section{Keywords:} solar wind, ACE, Self-Organizing Maps, clustering, autoencoder, PCA, unsupervised, machine learning} %All article types: you may provide up to 8 keywords; at least 5 are mandatory.
\end{abstract}

\section{Introduction}
%\input{sections/introduction}

\section{Materials and Methods}

\subsection{Data and Processing}
\input{sections/data}

\subsection{Dimension Reduction and Clustering}
\input{sections/methods}

\section{Results and comparisons}
\input{sections/results}

\section{Discussion}
\input{sections/discussion}

\section{Additional Requirements}

\section*{Conflict of Interest Statement}
%All financial, commercial or other relationships that might be perceived by the academic community as representing a potential conflict of interest must be disclosed. If no such relationship exists, authors will be asked to confirm the following statement: 

The authors declare that the research was conducted in the absence of any commercial or financial relationships that could be construed as a potential conflict of interest.

\section*{Author Contributions}

JA created the software used in this work. RD provided important insights into the use of the machine learning techniques, and performed revisions of the different drafts. MEI gathered information from other experts in the domain and provided insights into the data use. GL supervised the work. All authors contributed to manuscript revision, read and approved the submitted version.

\section*{Funding}

JA has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No 754304 (\href{https://www.deep-projects.eu}{DEEP-EST, www.deep-projects.eu}).

RD has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No 776262 (\href{https://www.aida-space.eu}{AIDA, www.aida-space.eu}).

\section*{Acknowledgments}

\section*{Supplemental Data}
Codes can be found in the \href{http://github.com/murci3lag0}{github.com/murci3lag0}.

\section*{Data Availability Statement}
\label{sec:repos}

Publicly available datasets were analyzed in this study. This data can be found here: \href{http://github.com/murci3lag0}{github.com/murci3lag0}.

The original contributions presented in the study are publicly available. This data can be found here: \href{http://github.com/murci3lag0}{github.com/murci3lag0}.

ACE datasets downloaded from \href{ftp://mussel.srl.caltech.edu/pub/ace/level2/multi}{ftp://mussel.srl.caltech.edu/pub/ace/level2/multi}.

ACE multi-instrument data set description: \href{http://www.srl.caltech.edu/cgi-bin/dib/rundibviewmultil2/ACE/ASC/DATA/level2/multi}{http://www.srl.caltech.edu/cgi-bin/dib/rundibviewmultil2/ACE/ASC/DATA/level2/multi}

Sunspots from \href{http://www.sidc.be/silso/datafiles}{http://www.sidc.be/silso/datafiles}

% Please see the availability of data guidelines for more information, at https://www.frontiersin.org/about/author-guidelines#AvailabilityofData

\bibliographystyle{frontiersinSCNS_ENG_HUMS} % for Science, Engineering and Humanities and Social Sciences articles, for Humanities and Social Sciences articles please include page numbers in the in-text citations
%\bibliographystyle{frontiersinHLTH&FPHY} % for Health, Physics and Mathematics articles
\bibliography{swinsom}

%%% Make sure to upload the bib file along with the tex file and PDF
%%% Please see the test.bib file for some examples of references

\section*{Tables}

\begin{table}\centering
	\begin{tabular}{@{}llll@{}}
		\toprule
		\# & Solar wind type name & Condition & Reference \\
		\midrule
		1 & Coronal hole wind & $O^{7+}/O^{6+} \leq 0.145$ & \citep{Zhao2009} \\
		2 & ICMEs & $O^{7+}/O^{6+}\leq 6.008e^{(-0.00578V_{sw})}$ & \\
		4 & Non-coronal hole wind & $0.145 < O^{7+}/O^{6+} < 6.008e^{(-0.00578V_{sw})} $ & \\
		\midrule
		0 & Streamer belt origin & Not type 1, 2, or 3 & \citep{Xu2015} \\
		1 & Coronal hole origin & Not type 2, and & \\
		  &  & $\log_{10}(S_p) > -0.525 \log_{10}(T_{\text{exp}}/T_p) - 0.676\log_{10}(V_A) + 1.74$ & \\
		2 & Ejecta & $\log_{10}(V_A) > 0.055\log_{10}(T_{\text{exp}}/T_p) + 0.277 \log_{10}(S_p) + 1.83$ & \\
		3 & Sector reversal origin & Not type 2, and & \\
		  & & $\log_{10}(S_p) < -0.125 \log_{10}(T_{\text{exp}}/T_p) - 0.658\log_{10}(V_A) + 1.04$ &  \\
		\bottomrule
	\end{tabular}
	\caption{The four solar wind types, as defined by \citep{Zhao2009} (top) and \citep{Xu2015} (bottom).}
	\label{tab:swtypes}
\end{table}

\begin{table}\centering
	\begin{tabular}{@{}lcccc@{}}
		\toprule
		Method & $m$ & $n$ & $\epsilon$ & $\sigma$ or $\eta$ \\
		\midrule
		\multirow{4}{*}{SOM} & v1 & v2 \\
						  	  & v3 & v4 \\
						  	  & v3 & v4 \\
						  	  & v3 & v4 \\
		\midrule
		\multirow{4}{*}{DSOM} & v1 & v2 \\
							   & v3 & v4 \\
							   & v3 & v4 \\	
							   & v3 & v4 \\
		\bottomrule
	\end{tabular}
	\caption{Hyper-parameters for the SOM/DSOM classification, obtained using Hyper-Parameter Optimization (HPO).}
	\label{tab:hpo}
\end{table}

\begin{table}\centering
	\begin{tabular}{@{}rlcccc@{}}
		\toprule
		ID & Name  & A & R & X & Z \\
		\midrule
		1 & O7to6 & $\checkmark$ & $\checkmark$ & & $\checkmark$ \\
		2 & proton\_speed & $\checkmark$ & $\checkmark$ & & $\checkmark$ \\
		3 & proton\_density & $\checkmark$ & $\checkmark$ & & \\
		4 & FetoO & $\checkmark$ & $\checkmark$ & & \\
		5 & avqFe & $\checkmark$ & $\checkmark$ & & \\
		6 & sigmac$^{(*)}$ & $\checkmark$ & $\checkmark$ & & \\
		7 & sigmar$^{(*)}$ & $\checkmark$ & $\checkmark$ & & \\
		8 & Bmag & $\checkmark$ & $\checkmark$ & & \\
		9 & Sp & $\checkmark$ & & $\checkmark$ & \\
		10 & Va & $\checkmark$ & &$\checkmark$ & \\
		11 & Tratio & $\checkmark$ & & $\checkmark$ & \\
		12 & proton\_temp & $\checkmark$ & & & \\
		13 & Ma & $\checkmark$ & & & \\
		14 & He4toprotons & $\checkmark$ & & & \\
		15 & C6to5 & $\checkmark$ & & & \\
		16 & proton\_speed\_range & $\checkmark$ & & & \\
		17 & proton\_density\_range & $\checkmark$ & & & \\
		18 & proton\_temp\_range & $\checkmark$ & & & \\
		19 & Bgsm\_x\_range & $\checkmark$ & & & \\
		20 & Bgsm\_y\_range & $\checkmark$ & & & \\
		21 & Bgsm\_z\_range & $\checkmark$ & & & \\
		22 & Bmag\_range & $\checkmark$ & & & \\
		23 & Bmag\_acor$^{(*)}$ & $\checkmark$ & & & \\
		24 & Bmag\_mean & $\checkmark$ & & & \\
		25 & Bmag\_std & $\checkmark$ & & & \\
		26 & Lambda$^{(*)}$ & $\checkmark$ & & & \\
		27 & Delta$^{(*)}$ & $\checkmark$ & & & \\
		\midrule
		 & Initial year & 1998 & 2002 & 2000 & 2000 \\
		 & Final year & 2011 & 2004 & 2011 & 2011 \\
		 & PCA transformation & $\checkmark$ & $\checkmark$ & $\checkmark$ &  \\
		 & AE encoding & $\checkmark$ & $\checkmark$ & & \\
		 & Neurons/ encoding layer & [27, 15, 6, 3] & [8, 6, 4, 3] & & \\
		\bottomrule
	\end{tabular}
	\caption{List of features used for each classification case. The logarithm of all quantities was used, except for the features marked with an asterisk (*). Bottom: data range and transformations used.}
	\label{tab:features}
\end{table}

\section*{Figure captions}

%%% Please be aware that for original research articles we only permit a combined number of 15 figures and tables, one figure with multiple subfigures will count as only one figure.
%%% Use this if adding the figures directly in the mansucript, if so, please remember to also upload the files when submitting your article
%%% There is no need for adding the file termination, as long as you indicate where the file is saved. In the examples below the files (logo1.eps and logos.eps) are in the Frontiers LaTeX folder
%%% If using *.tif files convert them to .jpg or .png
%%%  NB logo1.eps is required in the path in order to correctly compile front page header %%%

%%% If you are submitting a figure with subfigures please combine these into one image file with part labels integrated.
%%% If you don't add the figures in the LaTeX files, please upload them when submitting the article.
%%% Frontiers will add the figures at the end of the provisional pdf automatically
%%% The use of LaTeX coding to draw Diagrams/Figures/Structures should be avoided. They should be external callouts including graphics.

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=.5\textwidth]{Amaya/datacoverage}
	\end{center}
	\caption{Histogram of the number of entries in the data set for this work.}\label{fig:datacoverage}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=16cm]{Roberts/dimreduc}% This is a *.eps file
	\end{center}
	\caption{Dimension reduction scatter plot (first four columns, panels a-d and g-j) and density plots (two last columns, panels e, f, k, l). Top row: PCA transformation. Bottom row: autoencoder transformation. The y-axis in all the panels represent the second component of the transformed space. The x-axis in the odd (even) columns correspond to the first (third) component.}\label{fig:dimreduc}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=16cm]{Roberts/clustering}% This is a *.eps file
	\end{center}
	\caption{Scatter plot of the data set points projected on the transformed space. The two left (right) columns correspond to the PCA (autoencoder) projection. The y-axis in all the panels represent the second component of the transformed space. The x-axis in the odd (even) columns correspond to the first (third) component. First row: k-means classification. Second row: Gaussian Mixture Model classification. Third row: Self-Organizing Map classification.}\label{fig:clustering}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=16cm]{Amaya/maps}% This is a *.eps file
	\end{center}
	\caption{Visualization of the Self-Organizing maps. In columns 2 to 4 the colors evolve from black, to orange to yellow. Top left panel: histogram with the density of data points superposed by the code words (nodes) of the SOM. As an example, a single node is connected to its closest neighbors by red lines. Second panel, top row, Hit map: colred by the sum of the node components, the size of the hexagon corresponds to the number of points associated to the node, and the lines between nodes correspond to their relative distance. Third panel top row: example of the corresponding feature value to each node. Top row last panel: example of the statistics applied to the points associated to each node, in this case mean value of `avqO' in color, with solar wind type hits as hexagon size. Bottom row: the three components of the map nodes, where the first panel is an RGB combination of the following three.}\label{fig:maps}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=13cm]{Amaya/datarange}% This is a *.eps file
	\end{center}
	\caption{Composition of all the solar wind points. Violin plot superposed by a box plot of the solar wind features. The box hight represents the Inter Quartile Range (IQR), the central continuous line represents the median and the dashed line the mean. The central notch represents the confidence of the median. The upper (lower) whiskers represent the lesser 25th (greater 75th) percentile of the data. }\label{fig:datarange}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=5cm]{Amaya/classesdatarange-kmeans}\hfill
		\includegraphics[width=5cm]{Amaya/classesdatarange-gmm}\hfill
		\includegraphics[width=5cm]{Amaya/classesdatarange-som}
	\end{center}
	\caption{Solar wind `fingerprint': composition of each class (one color per class), obtained with the k-means classification (left), the GMM classification (center), and the DSOM classification (right).}\label{fig:classesdatarange}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=18cm]{Amaya/timeseries}% This is a *.eps file
	\end{center}
	\caption{Four months of solar wind information. This is the same period used by \citep{Roberts2020}. Top three panels: solar wind speed colored by a) k-means classification, b) Gaussian Mixture Model classification, and c) DSOM classification. The colors correspond to the `fingerprints' in Fig.\ref{fig:classesdatarange}. Vertical gray zones correspond to Richardson and Cane ICME catalog entries, and vertical dashed lines to entries in the UNH and CfA catalogs. d) Magnetic field polarity color representation using $B_{x,y}$ as the top and bottom limits: red $B_x>B_y$, green $B_x<B_y$. The vertical gray zones correspond periods of 27 days. e) $B_z$ component of the magnetic field: blue positive, red negative. f) plot of the ionized oxygen (dotted line), and the solar wind type limits from \citep{Zhao2009} in table \ref{tab:swtypes}}\label{fig:timeseries}
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=18cm]{Amaya/tsfeatures-som}% This is a *.eps file
	\end{center}
	\caption{Solar wind features in the same window of time as Fig.\ref{fig:timeseries}. Al points are colored by the class number obtained by the DSOM algorithm. Vertical blue zones correspond to Richardson and Cane ICME catalog entries, and vertical dashed lines to entries in the UNH and CfA catalogs. The vertical gray zones correspond periods of 27 days.}\label{fig:tsfeatures-som}.
\end{figure}

\begin{figure}[h!]
	\begin{center}
		\includegraphics[width=10cm]{architecture}% This is a *.eps file
	\end{center}
	\caption{General architecture used in model A: data set entries are encoded into a latent space with a much smaller number of dimensions. The encoded data is used to train the SOM. Clustering techniques are used to group together nodes of the SOM lattice.}\label{fig:architecture}
\end{figure}

\end{document}
